define(["dInherit","dLocalStorage","dAbstractStorage","dDate","dLog","dValidate"],function(e,t,n,r,i,s){var o={ERROR_OPTIONS:"error Store option",ERROR_KEY:"error Store key",ERROR_EXPIR:"error Store expir"},u=e(n,{__propertys__:function(){this.key="",this._now=new r,this.expir="7D",this.iProxy=t.getInstance(),this.error=$.proxy(i.defaultLog.error,i.defaultLog),this._model={}},initialize:function(e){this._checkOpt(e)&&($.extend(this,e),this.expir=this._getExpirDate(expir))},_checkOpt:function(e){var t=!0;if(!s.isObject(e))this.error(o.ERROR_OPTIONS),t=!1;else if(!s.isString(e.key)||e.key.length===0)this.error(o.ERROR_KEY),t=!1;else if(!s.isString(e.expir)||e.expir.length===0)this.error(o.ERROR_EXPIR),t=!1;return t},_getExpirDate:function(){var e=this.expir,t=this._now,n=e.length-1,r=e.charAt(n).toUpperCase(),i=parseInt(e.substring(0,n),10),s;switch(r){case"D":s=t.addDay(i);break;case"M":s=t.addMonth(i);break;case"H":s=t.addHours(i);break;case"I":s=t.addMinutes(i);break;default:s=t.addDay(7)}return s},set:function(e){this.iProxy.set(this.key,JSON.stringify(e),this.expir.getTime())},setAttr:function(e,t){var n=this.get();n[e+""]=t,this.set(n)},get:function(){return JSON.parse(this.iProxy.get(this.key))},getAttr:function(e){return this.get()[e]}});return u});